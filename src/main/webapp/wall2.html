<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="wall.css">

    <script type="text/javascript" src="resources/libs/ckeditor/ckeditor.js"></script>
    <script type="text/javascript" src="resources/libs/jquery_3.1.0.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('.post_add').click(function () {
                var CKEDITOR_BASEPATH = 'resources/libs/ckeditor/';
                showEditor();
            });
        });

        function showEditor() {
            var submit = $(".post_submit");
            try {
                CKEDITOR.replace('editor');
                /*editor.config.autoParagraph = false;*/
                //CKEDITOR.instances.editor.setData('<p></p>');
            } catch (e) {
                /*CKEDITOR.instances.editor.updateElement();
                CKEDITOR.replace('editor');*/
            }


            $(".post_add").css("display", "none");
            submit.css({"display": "inline"});
            submit.click(function () {
                var data = CKEDITOR.instances.editor.getData();
                hideEditor();

                var NAME = ''; //TODO server
                var IMG = ''; //TODO server
                var TIME = '';//getCurrentDate();

                $(".posts").prepend('<div class="post">' +
                    '<div class="message_info_wrapper">' +
                    '<div class="message_info_w">' +
                    '<img src="' + IMG + '" class="person_photo_small">' +
                    '<div class="person_name_w">' + NAME + '</div>' +
                    '<div class="message_time_w">' + TIME + '</div>' +
                    '</div>' +
                    '</div>' + data + '</div');

                //TODO server save
            });
        }




        function hideEditor() {
            var submit = $(".post_submit");
            $("#cke_editor").replaceWith($('.sample_editor'));
            submit.css("display", "none");
            $(".post_add").css("display", "inline");


            /*CKEDITOR.instances.editor.setData( '<p>Some other editor data.</p>', function()
            {
                CKEDITOR.instances.editor.resetDirty();
            } );*/
            CKEDITOR.instances.editor.destroy();

        }

        /*<div class="message_info_wrapper">
            <div class="message_info_w">
            <img src="" class="person_photo_small">
            <div class="person_name_w">Булыгина Мария Ивановна</div>
        <div class="message_time_w">10: 30 21.09.2018</div>
        </div>
        </div>*/
    </script>
</head>
<body>
<div class="post_add_wrapper">
    <button class="post_add">Добавить новость</button></div>
<textarea name="editor" class="editor" rows="10" cols="80"></textarea>
<button class="post_submit">Опубликовать новость</button>
<textarea name="sample_editor" class="sample_editor" rows="10" cols="80"></textarea>
<div class="posts">
    <div class="post">
        <div class="message_info_wrapper">
            <div class="message_info_w">
                <img src="" class="person_photo_small">
                <div class="person_name_w">Булыгина Мария Ивановна</div>
                <div class="message_time_w">10: 30 21.09.2018</div>
            </div>
        </div>
        <p>ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем ПРивет всем </p>
    </div>
</div>
</body>
</html>